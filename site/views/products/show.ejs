<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head') %>
<body>
    <%- include('../partials/header') %>

    <section class="top-nav">
        <nav class="top-nav-start breadcrumb">
            <a href="/">Inicio</a>
            <a href="/products/show">Detalles del producto</a>
        </nav>
    </section>

    <main class="product-container">
        <div class="margin-product-container">
            <div class="row">
                <div class="col-12 col-md-6 col-lg-6">
                    <div class="row ">
                        <div class="col-md-3 col-lg-3">
                            <aside>
                                <% for(let i=0; i<product.images.length; i++) { %>
                                    <figure class="box-container">
                                        <a onclick="showSlides(<%= i+1 %>)">
                                            <img src="/images/products/<%= product.images[i] ? product.images[i].name : '' %>" onerror="this.src='/images/products/default-image.png'" alt="foto miniatura del producto">
                                        </a>
                                    </figure>
                                <% } %>
                            </aside>
                        </div>
                        <div class="col-md-9 col-lg-9">
                            <% for(let i=0; i<product.images.length; i++) { %>
                                <figure class="slide-container img-<%= i+1 %>">
                                    <img src="/images/products/<%= product.images[i] ? product.images[i].name : '' %>" onerror="this.src='/images/products/default-image.png'" alt="foto del producto">
                                </figure>
                            <% } %>
                        </div>
                        <a class="prev-link show-mobile" onclick="prevSlide()">&#10094;</a>
                        <a class="next-link show-mobile" onclick="nextSlide()">&#10095;</a>
                    </div>
                </div>
                <div class="col-lg-1 line-center">
                    <div class="vertical-line"></div>
                </div>
                <div class="col-12 col-md-6 col-lg-5">
                    <article class="product-details row main-center">
                            <i class="far fa-heart heart-icon right-heart"></i>
                            <div class="product-title title"><%= product.name %> </div>
                            <div class="price-detail">
                                <span class="product-price previous-price" style="<%= product.price == product.offerPrice ? 'display: none' : '' %>">$ <%= product.price%></span>
                                <span class="current-price">$ <%= product.offerPrice %> </span>
                                <p class="stock">stock disponible</p>
                            </div>
                            <p class="product-description text"><%= product.description %> </p>
                            <div class="select-size">
                                <label for="size">Talle:</label>
                                <select name="size" id="size">
                                    <% productsSize.forEach(size => { %>
                                        <option value="<%= size.id %>">
                                            <%= size.name %>
                                        </option> 
                                    <% }) %>
                                </select>
                            </div>
                            <!-- Tipo de simpsocks -->
                            <span> Tipo: <%= product.type.name%></span>
                            <div>Categorías:
                                <span class="labels">
                                    <% product.categories.forEach(category => { %>
                                        <span><%= category.name %></span>
                                    <% }) %>
                                </span>
                            </div>
                        <div class="product-actions">
                            <form action="/products/cart" method="GET">
                                <button type="submit" class="btn btn-secondary btn-cart">Añadir al carrito</button>
                            </form>
                            <form action="/error" method="POST">
                                <button type="submit" class="btn btn-primary">Comprar</button>
                            </form>
                        </div>
                    </article>
                </div>
            </div>
         </div>
    </main>

    <% if (related && related.length) { %>
        <section class="related-products-container">
            <span class="title">Productos Relacionados</span>
            <div class="row nowrap simple-slider">
                <% related.forEach(product => { %>
                    <div class="col-md-6 col-lg-3 simple-slide">
                        <%- include('product', {product}) %>
                    </div>
                <% }) %>
            </div>
        </section>
    <% } %>

    <%- include("../partials/footer")%>
    <script src="/js/slider.js"></script>
</body>
</html>